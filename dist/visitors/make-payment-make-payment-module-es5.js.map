{"version":3,"sources":["/./src/app/members/make-payment/make-payment.component.html","/./src/app/members/make-payment/make-payment.component.ts","/./src/app/members/make-payment/make-payment.module.ts"],"names":[],"mappings":"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","file":"make-payment-make-payment-module-es5.js","sourcesContent":["module.exports = \"<lib-alert\\n  [title]=\\\"response.title\\\"\\n  [type]=\\\"response.type\\\"\\n  [message]=\\\"response.message\\\"\\n  *ngIf=\\\"!hideAlert\\\"\\n></lib-alert>\\n<app-message-box\\n  [action]=\\\"'0'\\\"\\n  [buttonText]=\\\"'Pay membership fee'\\\"\\n  (btnClick)=\\\"startPayment()\\\"\\n  [isBusy]=\\\"isBusy\\\"\\n></app-message-box>\\n\"","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Router } from '@angular/router';\nimport {\n  BaseComponent,\n  RequestService,\n  ScriptLoaderService,\n  AuthService,\n} from 'shared';\nimport { PaystackWidget } from 'helpers';\nimport { CommonService } from '../services/common-service.service';\n\n@Component({\n  selector: 'app-make-payment',\n  templateUrl: './make-payment.component.html',\n})\nexport class MakePaymentComponent extends BaseComponent\n  implements OnInit, OnDestroy {\n  isBusy = false;\n  paystackWidget: any;\n  constructor(\n    private requestServie: RequestService,\n    private scriptLoaderService: ScriptLoaderService,\n    private authService: AuthService,\n    private router: Router,\n    private commonService: CommonService,\n  ) {\n    super();\n  }\n\n  ngOnInit() {\n    this.commonService.setPageTitle('Make Payment');\n  }\n\n  ngOnDestroy() {\n    super.ngOnDestroy();\n  }\n\n  validatePayment(ref: string) {\n    this.subscription.add(\n      this.requestServie.validatePayment(ref).subscribe(\n        _ => {\n          this.isBusy = false;\n          const member = this.authService.getMember();\n          this.authService.setMember({ ...member, isActive: true });\n          this.router.navigateByUrl('/members/dashboard');\n        },\n        error => {\n          this.handleError(error);\n        },\n      ),\n    );\n  }\n\n  openPaystack(data: any) {\n    this.paystackWidget = new PaystackWidget(\n      data,\n      (response: any) => {\n        this.validatePayment(response.reference);\n      },\n      () => {\n        this.isBusy = false;\n      },\n    );\n    this.paystackWidget.open();\n  }\n\n  processPayment(data: any) {\n    if (!this.paystackWidget) {\n      this.scriptLoaderService.load('paystack').then(() => {\n        this.openPaystack(data);\n      });\n    } else {\n      this.openPaystack(data);\n    }\n  }\n\n  startPayment() {\n    this.isBusy = true;\n    this.subscription.add(\n      this.requestServie\n        .requestPayment('plan_membership_fee')\n        .subscribe(response => {\n          const { data } = response;\n          this.processPayment(data);\n        }),\n    );\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport { CommonModule } from '@angular/common';\nimport { SharedModule } from 'shared';\nimport { MakePaymentComponent } from './make-payment.component';\nimport { MessageBoxModule } from '../message-box/message-box.module';\n\n@NgModule({\n  declarations: [MakePaymentComponent],\n  imports: [\n    CommonModule,\n    SharedModule,\n    MessageBoxModule,\n    RouterModule.forChild([\n      {\n        path: '',\n        pathMatch: 'full',\n        component: MakePaymentComponent,\n      },\n    ]),\n  ],\n})\nexport class MakePaymentModule {}\n"],"sourceRoot":""}